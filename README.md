# 邮件分类项目

## 一、核心功能
本项目成功搭建了一套基于朴素贝叶斯算法的邮件分类系统，它能够精准识别邮件，将其区分为垃圾邮件（spam）与正常邮件（ham）两类。

## 二、算法基础
### （一）多项式朴素贝叶斯分类器
本项目采用多项式朴素贝叶斯（Multinomial Naive Bayes）分类器，其依托两个关键假设：
- **特征条件独立性假设**：在给定邮件类别的情况下，各个特征之间相互独立，即一个特征的出现与否不会影响其他特征出现的概率。
- **多项式分布假设**：特征以词频计数的形式呈现，用于描述邮件文本中词语出现的统计特性。

### （二）贝叶斯定理的应用
在邮件分类过程中，贝叶斯定理的应用形式为：P(Class|Document) \ P(Document|Class)*P(Class)。
- P(Class)代表类别的先验概率，即根据已有数据统计得到的邮件属于某一类（垃圾邮件或正常邮件）的概率。
- P(Document|Class) = \prod P(Word|Class)，基于特征条件独立性假设，它表示在已知邮件类别的情况下，文档中各个单词出现的概率乘积。
- P(Class|Document)是给定文档属于某类的后验概率，通过计算该值来判断邮件属于垃圾邮件还是正常邮件。

## 三、数据处理流程
1. **分词处理**：利用中文分词工具（如jieba）对邮件文本进行处理，将连续的文本分割成一个个独立的词语，形成词语序列。
2. **停用词过滤**：从邮件文本中去除那些常见的无实际意义的词汇，比如“的”“是”“了”等，以减少数据噪声，提高分类效率。
3. **文本清洗**：通过特定的规则和方法，去除邮件文本中的标点符号、数字以及其他非文本内容，使文本更加纯净，便于后续处理。
4. **特征构建**：根据选定的方法，将处理后的文本转化为适合模型训练和分类的特征向量。

## 四、特征构建过程
### （一）高频词特征选择
1. 对所有训练邮件文本中的词语出现频率进行统计。
2. 从统计结果中挑选出出现频率最高的top_k个词语作为特征。
3. 将每封邮件表示为这top_k个词语的出现次数向量。
4. **数学表达**：X[i][j] = count(word_j \ in \ document_i)，其中X[i][j]表示第i封邮件中第j个特征词的出现次数。

### （二）TF-IDF特征加权
1. **计算词频（TF）**：统计每个词语在单封邮件中出现的频率，即TF = {词在文档中出现的次数}/{文档中词语的总次数}。
2. **计算逆文档频率（IDF）**：IDF = log({总文档数}/{包含该词的文档数})，它衡量了一个词语在整个文档集合中的重要性。
3. **计算TF-IDF**：TF-IDF = TF * IDF，通过两者乘积突出在特定文档中频繁出现且在其他文档中较少出现的词语。
4. 选取TF-IDF值最高的top_k个特征。
5. **数学表达**：X[i][j] = TF(word_j in document_i) *IDF(word_j)，X[i][j]表示i封邮件中第j个特征词的TF-IDF值。

### （三）差异对比
| 特征类型 | 缺点 | 优点 |
| ---- | ---- | ---- |
| 高频词 | 无法有效区分不同词语在分类中的重要程度差异，常见词可能会对分类结果产生较大干扰 | 计算过程简单直接，易于实现和理解 |
| TF-IDF | 计算过程相对复杂，涉及到词频和逆文档频率的计算，计算量较大 | 能够根据词语在文档集合中的分布情况，准确反映其重要性，降低常见词的权重 |

## 五、特征模式切换方法
在代码中，通过设置`feature_type`参数来灵活选择特征提取方式：
```python
# 使用高频词特征
features, vectorizer = get_features(texts, feature_type='frequency')

# 使用TF-IDF特征
features, vectorizer = get_features(texts, feature_type='tfidf')
```
 
## 六、 运行结果 
 
### 1. classif运行结果
<img src="https://github.com/zss444/GitDemo/blob/master/341.png">
  
### 2. TF-IDF运行结果

 <img src="https://github.com/zss444/GitDemo/blob/master/22.png">

 
### 3. 样本平衡处理运行结果
 <img src="https://github.com/zss444/GitDemo/blob/master/44.png">

 
### 4. 增加模型评估指标运行结果
 <img src="https://github.com/zss444/GitDemo/blob/master/55.png">
